{"ast":null,"code":"import React,{useState,useEffect,useContext,useCallback}from'react';import{useForm,Controller}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import*as yup from'yup';import axios from'axios';import{AuthContext}from'../../context/AuthContext';import AllergyItem from'../../components/parent/AllergyItem';import ChronicIllnessItem from'../../components/parent/ChronicIllnessItem';import EmergencyContactItem from'../../components/parent/EmergencyContactItem';import VaccinationItem from'../../components/parent/VaccinationItem';import{useLocation,Link}from'react-router-dom';// Added Link\nimport{useAlert}from'../../hooks/useAlert';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const schema=yup.object().shape({studentCode:yup.string().required(\"Child selection is required\"),allergies:yup.array().of(yup.string().nullable()),// Allow null or empty strings initially\nchronicIllnesses:yup.array().of(yup.string().nullable()),// Allow null or empty strings initially\nmedicalHistory:yup.string().nullable(),emergencyContacts:yup.array().of(yup.object().shape({name:yup.string().required(\"Contact name is required\"),relationship:yup.string().required(\"Relationship is required\"),phone:yup.string().required(\"Phone number is required\"),isEmergency:yup.boolean()})).min(1,\"At least one emergency contact is required\"),visionStatus:yup.string().nullable(),hearingStatus:yup.string().nullable(),vaccinations:yup.array().of(yup.object().shape({vaccineName:yup.string().required(\"Vaccine name is required\"),vaccinationDate:yup.date().required(\"Date administered is required\").typeError(\"Invalid date\"),notes:yup.string().nullable()})),specialNeeds:yup.string().nullable(),physicalLimitations:yup.string().nullable(),mentalHealthConcerns:yup.string().nullable(),dietaryRestrictions:yup.string().nullable()});const HealthDeclaration=()=>{var _errors$allergies,_errors$chronicIllnes;const{currentUser}=useContext(AuthContext);const{successAlert,errorAlert,cancelConfirm}=useAlert();const location=useLocation();// Added to get state from navigation\nconst[children,setChildren]=useState([]);const[selectedStudentCode,setSelectedStudentCode]=useState('');const[initialLoading,setInitialLoading]=useState(true);// For children list\nconst[isFetchingDeclaration,setIsFetchingDeclaration]=useState(false);// For health data for a selected child\nconst[submitting,setSubmitting]=useState(false);// For form submission (save/submit)\nconst{control,handleSubmit,setValue,watch,reset,formState:{errors}}=useForm({resolver:yupResolver(schema),defaultValues:{studentCode:'',allergies:[],chronicIllnesses:[],emergencyContacts:[{name:'',relationship:'',phone:'',isEmergency:true}],vaccinations:[],visionStatus:'',hearingStatus:'',specialNeeds:'',physicalLimitations:'',mentalHealthConcerns:'',dietaryRestrictions:'',medicalHistory:''}});// Effect to fetch parent's children\nuseEffect(()=>{const fetchChildren=async()=>{if(currentUser&&currentUser.username){// Use username (parent_code)\nsetInitialLoading(true);try{var _location$state;const token=localStorage.getItem('token');// Assuming /api/parent/students returns children with studentCode\nconst childrenResponse=await axios.get(`/api/parent/students`,{headers:{Authorization:`Bearer ${token}`}});setChildren(childrenResponse.data||[]);// If studentCode is passed via navigation state, set it\nif((_location$state=location.state)!==null&&_location$state!==void 0&&_location$state.studentCode){setSelectedStudentCode(location.state.studentCode);setValue('studentCode',location.state.studentCode);// Also set in RHF\n}}catch(error){console.error('Error fetching children:',error);setChildren([]);}finally{setInitialLoading(false);}}else if(!currentUser){setInitialLoading(true);// Still waiting for currentUser\n}else{setInitialLoading(false);// currentUser loaded but no ID, or other issue\nsetChildren([]);}};fetchChildren();},[currentUser,location.state,setValue]);// Added setValue to dependencies  // Reset form to empty defaults with optionally keeping the student code\nconst resetFormToDefaults=useCallback(function(){let studentCodeToKeep=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';reset({studentCode:studentCodeToKeep,allergies:[],chronicIllnesses:[],emergencyContacts:[{name:'',relationship:'',phone:'',isEmergency:true}],vaccinations:[],visionStatus:'',hearingStatus:'',specialNeeds:'',physicalLimitations:'',mentalHealthConcerns:'',dietaryRestrictions:'',medicalHistory:''});},[reset]);// Effect to handle student code changes (but not fetch previous declaration data)\nconst fetchHealthDeclaration=useCallback(async studentCodeToFetch=>{if(!studentCodeToFetch){resetFormToDefaults('');// Reset with empty student code\nreturn;}// Just set the form to defaults with the selected student code\nresetFormToDefaults(studentCodeToFetch);setIsFetchingDeclaration(false);},[resetFormToDefaults]);// This useEffect listens to selectedStudentCode and calls fetchHealthDeclaration\nuseEffect(()=>{fetchHealthDeclaration(selectedStudentCode);},[selectedStudentCode,fetchHealthDeclaration]);const onSubmit=async formData=>{if(!selectedStudentCode){errorAlert(\"Vui lòng chọn con em trước.\");return;}setSubmitting(true);try{const token=localStorage.getItem('token');// Prepare health declaration data\nconst dataToSubmit={...formData,studentCode:selectedStudentCode// Ensure student code is included\n};// Submit the health declaration to the correct endpoint\nconst response=await axios.post(`/api/health-declaration`,dataToSubmit,{headers:{Authorization:`Bearer ${token}`}});// Show success alert with information about viewing the health declaration and checking status\nsuccessAlert('Tờ khai sức khỏe đã được gửi thành công!\\n\\n'+'Tờ khai của bạn sẽ được xem xét bởi nhân viên y tế của trường. '+'Bạn có thể xem trạng thái tờ khai (Đang chờ, Đã duyệt, hoặc Từ chối) '+'trong phần Hồ sơ sức khỏe.');// Reset form and clear student selection after successful submission\nresetFormToDefaults('');setSelectedStudentCode('');}catch(error){var _error$response,_error$response$data;console.error('Error submitting health declaration:',error);errorAlert('Lỗi khi gửi tờ khai sức khỏe. Vui lòng thử lại. '+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message));}finally{setSubmitting(false);}};const handleCancel=async()=>{// Confirm before cancelling\nconst confirmed=await cancelConfirm();if(confirmed){// Reset the form to defaults and clear student selection\nresetFormToDefaults('');// Clear student selection\nsetSelectedStudentCode('');}};const addArrayItem=useCallback((fieldName,defaultItem)=>{const currentValues=watch(fieldName)||[];setValue(fieldName,[...currentValues,defaultItem]);},[watch,setValue]);const removeArrayItem=useCallback((fieldName,index)=>{const currentValues=watch(fieldName)||[];setValue(fieldName,currentValues.filter((_,i)=>i!==index));},[watch,setValue]);// For simple string array items (allergies, chronicIllnesses)\nconst handleSimpleArrayItemChange=useCallback((fieldName,index,value)=>{const currentValues=watch(fieldName)||[];const newValues=[...currentValues];newValues[index]=value;setValue(fieldName,newValues);},[watch,setValue]);// For array of objects items (medications, emergencyContacts, vaccinations)\nconst handleNestedObjectArrayItemChange=useCallback((fieldName,index,event)=>{const{name,value,type,checked}=event.target;const currentValues=watch(fieldName)||[];const newValues=[...currentValues];newValues[index]={...newValues[index],[name]:type==='checkbox'?checked:value};setValue(fieldName,newValues);},[watch,setValue]);// Main loading state: waiting for currentUser to determine if parent can access\nif(!currentUser&&initialLoading){return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-4 text-lg text-gray-700\",children:\"Loading user information...\"})]});}// If currentUser is loaded but not a parent or no ID (should be handled by ProtectedRoute, but as a fallback)\nif(!currentUser||!currentUser.id){return/*#__PURE__*/_jsx(\"div\",{className:\"p-6 text-center text-red-500\",children:\"Access Denied or User not properly loaded.\"});}// Skeleton Loader for the form content area\nconst FormSkeleton=()=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-8 animate-pulse\",children:[[...Array(5)].map((_,i)=>/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-6 bg-gray-300 rounded w-1/3 mb-2\"}),\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 bg-gray-300 rounded\"}),\" \",i<2&&/*#__PURE__*/_jsx(\"div\",{className:\"h-8 bg-gray-300 rounded w-1/4 mt-2\"}),\" \"]})]},i)),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 pt-6 border-t border-gray-200 mt-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-10 bg-gray-300 rounded w-28\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"h-10 bg-gray-300 rounded w-36\"}),\" \"]})]});return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 py-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-lg\",children:[\"          \",/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Health Declaration\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-x-2\",children:/*#__PURE__*/_jsx(Link,{to:\"/parent/health-records\",className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",children:\"View Health Records\"})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"Submit a new health declaration for your child. You can view all submitted declarations in the Health Records section.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"studentCodeSelect\",className:\"block text-sm font-medium text-gray-700 mb-1\",children:\"Select Child\"}),initialLoading&&children.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"h-10 bg-gray-300 rounded animate-pulse w-full p-2 border border-gray-300\"}):/*#__PURE__*/_jsxs(\"select\",{id:\"studentCodeSelect\",value:selectedStudentCode,onChange:e=>{const newStudentCode=e.target.value;setSelectedStudentCode(newStudentCode);setValue('studentCode',newStudentCode);// Update RHF studentCode field\n},className:`w-full p-2 border ${errors.studentCode?'border-red-500':'border-gray-300'} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500`,disabled:children.length===0||initialLoading||isFetchingDeclaration,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"-- Select a child --\"}),\"                  \",children.map(child=>/*#__PURE__*/_jsx(\"option\",{value:child.studentCode,children:child.fullName},child.studentCode))]}),errors.studentCode&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.studentCode.message}),!initialLoading&&children.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:\"No children found for your account.\"})]})]}),isFetchingDeclaration&&selectedStudentCode?/*#__PURE__*/_jsx(FormSkeleton,{}):!selectedStudentCode&&!initialLoading?/*#__PURE__*/// Message to show if children are loaded but none is selected yet\n_jsx(\"p\",{className:\"p-6 text-gray-600 text-center\",children:\"Please select a child to view or complete their health declaration.\"}):selectedStudentCode&&!isFetchingDeclaration?/*#__PURE__*/// Only render form if a child is selected and data is not being fetched\n_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"p-6 space-y-8\",children:[/*#__PURE__*/_jsx(Controller,{name:\"studentCode\",control:control,render:_ref=>{let{field}=_ref;return/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",...field});}}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Allergies\"}),/*#__PURE__*/_jsx(Controller,{name:\"allergies\",control:control,render:_ref2=>{let{field}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[(field.value||[]).map((allergy,index)=>/*#__PURE__*/_jsx(AllergyItem,{allergy:allergy,index:index,onChange:(idx,val)=>handleSimpleArrayItemChange('allergies',idx,val),onRemove:()=>removeArrayItem('allergies',index)},`allergy-${index}`)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>addArrayItem('allergies',''),className:\"text-indigo-600 hover:text-indigo-800 text-sm\",disabled:isFetchingDeclaration||submitting,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-1\"}),\" Add Allergy\"]})]});}}),(_errors$allergies=errors.allergies)===null||_errors$allergies===void 0?void 0:_errors$allergies.map((err,i)=>err&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:err.message||\"Allergy entry cannot be empty.\"},`err-allergy-${i}`))]}),\"              \",/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Chronic Illnesses\"}),/*#__PURE__*/_jsx(Controller,{name:\"chronicIllnesses\",control:control,render:_ref3=>{let{field}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[(field.value||[]).map((illness,index)=>/*#__PURE__*/_jsx(ChronicIllnessItem,{illness:illness,index:index,onChange:(idx,val)=>handleSimpleArrayItemChange('chronicIllnesses',idx,val),onRemove:()=>removeArrayItem('chronicIllnesses',index)},`chronic-${index}`)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>addArrayItem('chronicIllnesses',''),className:\"text-indigo-600 hover:text-indigo-800 text-sm\",disabled:isFetchingDeclaration||submitting,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-1\"}),\" Add Chronic Illness\"]})]});}}),(_errors$chronicIllnes=errors.chronicIllnesses)===null||_errors$chronicIllnes===void 0?void 0:_errors$chronicIllnes.map((err,i)=>err&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:err.message||\"Chronic illness entry cannot be empty.\"},`err-chronic-${i}`))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"medicalHistory\",className:\"block text-lg font-semibold text-gray-900\",children:\"Relevant Medical History\"}),/*#__PURE__*/_jsx(Controller,{name:\"medicalHistory\",control:control,render:_ref4=>{let{field}=_ref4;return/*#__PURE__*/_jsx(\"textarea\",{...field,id:\"medicalHistory\",rows:\"4\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"Describe any relevant past surgeries, hospitalizations, or significant medical conditions.\",disabled:isFetchingDeclaration||submitting});}}),errors.medicalHistory&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.medicalHistory.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Emergency Contacts\"}),/*#__PURE__*/_jsx(Controller,{name:\"emergencyContacts\",control:control,render:_ref5=>{let{field}=_ref5;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[(field.value||[]).map((contact,index)=>/*#__PURE__*/_jsx(EmergencyContactItem,{contact:contact,index:index,onChange:(idx,e)=>handleNestedObjectArrayItemChange('emergencyContacts',idx,e),onRemove:()=>removeArrayItem('emergencyContacts',index)},`contact-${index}`)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>addArrayItem('emergencyContacts',{name:'',relationship:'',phone:'',isEmergency:true}),className:\"text-indigo-600 hover:text-indigo-800 text-sm\",disabled:isFetchingDeclaration||submitting,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-1\"}),\" Add Emergency Contact\"]})]});}}),errors.emergencyContacts&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.emergencyContacts.message||\"Please ensure all emergency contact fields are correctly filled (name, relationship, phone are required).\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"visionStatus\",className:\"block text-lg font-semibold text-gray-900\",children:\"Vision Status\"}),/*#__PURE__*/_jsx(Controller,{name:\"visionStatus\",control:control,render:_ref6=>{let{field}=_ref6;return/*#__PURE__*/_jsx(\"input\",{...field,type:\"text\",id:\"visionStatus\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"e.g., Wears glasses, 20/20\",disabled:isFetchingDeclaration||submitting});}}),errors.visionStatus&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.visionStatus.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"hearingStatus\",className:\"block text-lg font-semibold text-gray-900\",children:\"Hearing Status\"}),/*#__PURE__*/_jsx(Controller,{name:\"hearingStatus\",control:control,render:_ref7=>{let{field}=_ref7;return/*#__PURE__*/_jsx(\"input\",{...field,type:\"text\",id:\"hearingStatus\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"e.g., Normal, Uses hearing aids\",disabled:isFetchingDeclaration||submitting});}}),errors.hearingStatus&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.hearingStatus.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:\"Vaccinations\"}),/*#__PURE__*/_jsx(Controller,{name:\"vaccinations\",control:control,render:_ref8=>{let{field}=_ref8;return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[(field.value||[]).map((vaccination,index)=>/*#__PURE__*/_jsx(VaccinationItem,{vaccination:vaccination,index:index,onChange:(idx,e)=>handleNestedObjectArrayItemChange('vaccinations',idx,e),onRemove:()=>removeArrayItem('vaccinations',index)},`vaccination-${index}`)),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:()=>addArrayItem('vaccinations',{vaccineName:'',vaccinationDate:'',notes:''}),className:\"text-indigo-600 hover:text-indigo-800 text-sm\",disabled:isFetchingDeclaration||submitting,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-1\"}),\" Add Vaccination\"]})]});}}),errors.vaccinations&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:\"Please ensure all vaccination fields are correctly filled (vaccine name and date are required).\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Other Health Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"specialNeeds\",className:\"block text-sm font-medium text-gray-700\",children:\"Special Needs or Accommodations\"}),/*#__PURE__*/_jsx(Controller,{name:\"specialNeeds\",control:control,render:_ref9=>{let{field}=_ref9;return/*#__PURE__*/_jsx(\"textarea\",{...field,id:\"specialNeeds\",rows:\"3\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"Describe any special needs...\",disabled:isFetchingDeclaration||submitting});}}),errors.specialNeeds&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.specialNeeds.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"physicalLimitations\",className:\"block text-sm font-medium text-gray-700\",children:\"Physical Limitations or Activity Restrictions\"}),/*#__PURE__*/_jsx(Controller,{name:\"physicalLimitations\",control:control,render:_ref0=>{let{field}=_ref0;return/*#__PURE__*/_jsx(\"textarea\",{...field,id:\"physicalLimitations\",rows:\"3\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"Describe any physical limitations...\",disabled:isFetchingDeclaration||submitting});}}),errors.physicalLimitations&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.physicalLimitations.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"mentalHealthConcerns\",className:\"block text-sm font-medium text-gray-700\",children:\"Mental or Emotional Health Concerns\"}),/*#__PURE__*/_jsx(Controller,{name:\"mentalHealthConcerns\",control:control,render:_ref1=>{let{field}=_ref1;return/*#__PURE__*/_jsx(\"textarea\",{...field,id:\"mentalHealthConcerns\",rows:\"3\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"Describe any mental health concerns...\",disabled:isFetchingDeclaration||submitting});}}),errors.mentalHealthConcerns&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.mentalHealthConcerns.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"dietaryRestrictions\",className:\"block text-sm font-medium text-gray-700\",children:\"Dietary Restrictions or Preferences\"}),/*#__PURE__*/_jsx(Controller,{name:\"dietaryRestrictions\",control:control,render:_ref10=>{let{field}=_ref10;return/*#__PURE__*/_jsx(\"textarea\",{...field,id:\"dietaryRestrictions\",rows:\"3\",className:\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"e.g., Vegetarian, Gluten-free...\",disabled:isFetchingDeclaration||submitting});}}),errors.dietaryRestrictions&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.dietaryRestrictions.message})]})]})]}),\"              \",/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleCancel,disabled:submitting,className:\"px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting||isFetchingDeclaration||!selectedStudentCode||initialLoading,className:\"px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\",children:submitting?'Submitting...':'Submit Declaration'})]})]}):null,!selectedStudentCode&&!initialLoading&&children.length>0&&/*#__PURE__*/_jsx(\"p\",{className:\"p-6 text-gray-600 text-center\",children:\"Please select a child to continue.\"}),!selectedStudentCode&&initialLoading&&/*#__PURE__*/_jsx(\"p\",{className:\"p-6 text-gray-600 text-center\",children:\"Loading children...\"})// This might briefly show if children array is empty during initial load\n]})})});};export default HealthDeclaration;","map":{"version":3,"names":["React","useState","useEffect","useContext","useCallback","useForm","Controller","yupResolver","yup","axios","AuthContext","AllergyItem","ChronicIllnessItem","EmergencyContactItem","VaccinationItem","useLocation","Link","useAlert","jsx","_jsx","jsxs","_jsxs","schema","object","shape","studentCode","string","required","allergies","array","of","nullable","chronicIllnesses","medicalHistory","emergencyContacts","name","relationship","phone","isEmergency","boolean","min","visionStatus","hearingStatus","vaccinations","vaccineName","vaccinationDate","date","typeError","notes","specialNeeds","physicalLimitations","mentalHealthConcerns","dietaryRestrictions","HealthDeclaration","_errors$allergies","_errors$chronicIllnes","currentUser","successAlert","errorAlert","cancelConfirm","location","children","setChildren","selectedStudentCode","setSelectedStudentCode","initialLoading","setInitialLoading","isFetchingDeclaration","setIsFetchingDeclaration","submitting","setSubmitting","control","handleSubmit","setValue","watch","reset","formState","errors","resolver","defaultValues","fetchChildren","username","_location$state","token","localStorage","getItem","childrenResponse","get","headers","Authorization","data","state","error","console","resetFormToDefaults","studentCodeToKeep","arguments","length","undefined","fetchHealthDeclaration","studentCodeToFetch","onSubmit","formData","dataToSubmit","response","post","_error$response","_error$response$data","message","handleCancel","confirmed","addArrayItem","fieldName","defaultItem","currentValues","removeArrayItem","index","filter","_","i","handleSimpleArrayItemChange","value","newValues","handleNestedObjectArrayItemChange","event","type","checked","target","className","id","FormSkeleton","Array","map","to","htmlFor","onChange","e","newStudentCode","disabled","child","fullName","render","_ref","field","_ref2","allergy","idx","val","onRemove","onClick","err","_ref3","illness","_ref4","rows","placeholder","_ref5","contact","_ref6","_ref7","_ref8","vaccination","_ref9","_ref0","_ref1","_ref10"],"sources":["C:/Users/trand/OneDrive/Documents/GitHub/SchoolMedicalManagement/frontend/src/pages/parent/HealthDeclaration.js"],"sourcesContent":["import React, { useState, useEffect, useContext, useCallback } from 'react';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport * as yup from 'yup';\r\nimport axios from 'axios';\r\nimport { AuthContext } from '../../context/AuthContext';\r\nimport AllergyItem from '../../components/parent/AllergyItem';\r\nimport ChronicIllnessItem from '../../components/parent/ChronicIllnessItem';\r\nimport EmergencyContactItem from '../../components/parent/EmergencyContactItem';\r\nimport VaccinationItem from '../../components/parent/VaccinationItem';\r\nimport { useLocation, Link } from 'react-router-dom'; // Added Link\r\nimport { useAlert } from '../../hooks/useAlert';\r\n\r\nconst schema = yup.object().shape({\r\n  studentCode: yup.string().required(\"Child selection is required\"),\r\n  allergies: yup.array().of(yup.string().nullable()), // Allow null or empty strings initially\r\n  chronicIllnesses: yup.array().of(yup.string().nullable()), // Allow null or empty strings initially\r\n  medicalHistory: yup.string().nullable(),\r\n  emergencyContacts: yup.array().of(yup.object().shape({\r\n    name: yup.string().required(\"Contact name is required\"),\r\n    relationship: yup.string().required(\"Relationship is required\"),\r\n    phone: yup.string().required(\"Phone number is required\"),\r\n    isEmergency: yup.boolean()\r\n  })).min(1, \"At least one emergency contact is required\"),\r\n  visionStatus: yup.string().nullable(),\r\n  hearingStatus: yup.string().nullable(),\r\n  vaccinations: yup.array().of(yup.object().shape({\r\n    vaccineName: yup.string().required(\"Vaccine name is required\"), \r\n    vaccinationDate: yup.date().required(\"Date administered is required\").typeError(\"Invalid date\"), \r\n    notes: yup.string().nullable()\r\n  })),\r\n  specialNeeds: yup.string().nullable(),\r\n  physicalLimitations: yup.string().nullable(),\r\n  mentalHealthConcerns: yup.string().nullable(),\r\n  dietaryRestrictions: yup.string().nullable()\r\n});\r\n\r\nconst HealthDeclaration = () => {\r\n  const { currentUser } = useContext(AuthContext);\r\n  const { successAlert, errorAlert, cancelConfirm } = useAlert();\r\n  const location = useLocation(); // Added to get state from navigation\r\n  const [children, setChildren] = useState([]);\r\n  \r\n  const [selectedStudentCode, setSelectedStudentCode] = useState('');\r\n  const [initialLoading, setInitialLoading] = useState(true); // For children list\r\n  const [isFetchingDeclaration, setIsFetchingDeclaration] = useState(false); // For health data for a selected child\r\n  const [submitting, setSubmitting] = useState(false); // For form submission (save/submit)\r\n    const { control, handleSubmit, setValue, watch, reset, formState: { errors } } = useForm({\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      studentCode: '',\r\n      allergies: [],\r\n      chronicIllnesses: [],\r\n      emergencyContacts: [{ name: '', relationship: '', phone: '', isEmergency: true }],\r\n      vaccinations: [],\r\n      visionStatus: '',\r\n      hearingStatus: '',\r\n      specialNeeds: '',\r\n      physicalLimitations: '',\r\n      mentalHealthConcerns: '',\r\n      dietaryRestrictions: '',\r\n      medicalHistory: ''\r\n    }\r\n  });\r\n\r\n  // Effect to fetch parent's children\r\n  useEffect(() => {\r\n    const fetchChildren = async () => {\r\n      if (currentUser && currentUser.username) { // Use username (parent_code)\r\n        setInitialLoading(true);\r\n        try {\r\n          const token = localStorage.getItem('token');\r\n          // Assuming /api/parent/students returns children with studentCode\r\n          const childrenResponse = await axios.get(`/api/parent/students`, { \r\n            headers: { Authorization: `Bearer ${token}` }\r\n          });\r\n          setChildren(childrenResponse.data || []);\r\n          // If studentCode is passed via navigation state, set it\r\n          if (location.state?.studentCode) {\r\n            setSelectedStudentCode(location.state.studentCode);\r\n            setValue('studentCode', location.state.studentCode); // Also set in RHF\r\n          }\r\n\r\n        } catch (error) {\r\n          console.error('Error fetching children:', error);\r\n          setChildren([]);\r\n        } finally {\r\n          setInitialLoading(false);\r\n        }\r\n      } else if (!currentUser) {\r\n        setInitialLoading(true); // Still waiting for currentUser\r\n      } else {\r\n        setInitialLoading(false); // currentUser loaded but no ID, or other issue\r\n        setChildren([]);\r\n      }\r\n    };\r\n    fetchChildren();  }, [currentUser, location.state, setValue]); // Added setValue to dependencies  // Reset form to empty defaults with optionally keeping the student code\r\n  const resetFormToDefaults = useCallback((studentCodeToKeep = '') => {\r\n    reset({\r\n      studentCode: studentCodeToKeep,\r\n      allergies: [],\r\n      chronicIllnesses: [],\r\n      emergencyContacts: [{ name: '', relationship: '', phone: '', isEmergency: true }],\r\n      vaccinations: [],\r\n      visionStatus: '',\r\n      hearingStatus: '',\r\n      specialNeeds: '',\r\n      physicalLimitations: '',\r\n      mentalHealthConcerns: '',\r\n      dietaryRestrictions: '',\r\n      medicalHistory: ''\r\n    });  }, [reset]);\r\n  // Effect to handle student code changes (but not fetch previous declaration data)\r\n  const fetchHealthDeclaration = useCallback(async (studentCodeToFetch) => {\r\n    if (!studentCodeToFetch) {\r\n      resetFormToDefaults(''); // Reset with empty student code\r\n      return;\r\n    }\r\n    \r\n    // Just set the form to defaults with the selected student code\r\n    resetFormToDefaults(studentCodeToFetch);\r\n    setIsFetchingDeclaration(false);\r\n    \r\n  }, [resetFormToDefaults]);\r\n\r\n  // This useEffect listens to selectedStudentCode and calls fetchHealthDeclaration\r\n  useEffect(() => {\r\n    fetchHealthDeclaration(selectedStudentCode);\r\n  }, [selectedStudentCode, fetchHealthDeclaration]);  const onSubmit = async (formData) => {\r\n    if (!selectedStudentCode) {\r\n      errorAlert(\"Vui lòng chọn con em trước.\");\r\n      return;\r\n    }\r\n    setSubmitting(true);\r\n    \r\n    try {\r\n      const token = localStorage.getItem('token');      \r\n      // Prepare health declaration data\r\n      const dataToSubmit = {\r\n        ...formData,\r\n        studentCode: selectedStudentCode // Ensure student code is included\r\n      };\r\n        // Submit the health declaration to the correct endpoint\r\n      const response = await axios.post(\r\n        `/api/health-declaration`, \r\n        dataToSubmit,\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      );        \r\n      \r\n      // Show success alert with information about viewing the health declaration and checking status\r\n      successAlert(\r\n        'Tờ khai sức khỏe đã được gửi thành công!\\n\\n' + \r\n        'Tờ khai của bạn sẽ được xem xét bởi nhân viên y tế của trường. ' +\r\n        'Bạn có thể xem trạng thái tờ khai (Đang chờ, Đã duyệt, hoặc Từ chối) ' +\r\n        'trong phần Hồ sơ sức khỏe.'\r\n      );\r\n      \r\n      // Reset form and clear student selection after successful submission\r\n      resetFormToDefaults('');\r\n      setSelectedStudentCode('');\r\n    } catch (error) {\r\n      console.error('Error submitting health declaration:', error);\r\n      errorAlert('Lỗi khi gửi tờ khai sức khỏe. Vui lòng thử lại. ' + (error.response?.data?.message || error.message));\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };  const handleCancel = async () => {\r\n    // Confirm before cancelling\r\n    const confirmed = await cancelConfirm();\r\n    if (confirmed) {\r\n      // Reset the form to defaults and clear student selection\r\n      resetFormToDefaults('');\r\n      // Clear student selection\r\n      setSelectedStudentCode('');\r\n    }\r\n  };\r\n\r\n  const addArrayItem = useCallback((fieldName, defaultItem) => {\r\n    const currentValues = watch(fieldName) || [];\r\n    setValue(fieldName, [...currentValues, defaultItem]);\r\n  }, [watch, setValue]);\r\n\r\n  const removeArrayItem = useCallback((fieldName, index) => {\r\n    const currentValues = watch(fieldName) || [];\r\n    setValue(fieldName, currentValues.filter((_, i) => i !== index));\r\n  }, [watch, setValue]);\r\n\r\n  // For simple string array items (allergies, chronicIllnesses)\r\n  const handleSimpleArrayItemChange = useCallback((fieldName, index, value) => {\r\n    const currentValues = watch(fieldName) || [];\r\n    const newValues = [...currentValues];\r\n    newValues[index] = value;\r\n    setValue(fieldName, newValues);\r\n  }, [watch, setValue]);\r\n\r\n  // For array of objects items (medications, emergencyContacts, vaccinations)\r\n  const handleNestedObjectArrayItemChange = useCallback((fieldName, index, event) => {\r\n    const { name, value, type, checked } = event.target;\r\n    const currentValues = watch(fieldName) || [];\r\n    const newValues = [...currentValues];\r\n    newValues[index] = {\r\n         ...newValues[index],\r\n         [name]: type === 'checkbox' ? checked : value \r\n    };\r\n    setValue(fieldName, newValues);\r\n  }, [watch, setValue]);\r\n\r\n\r\n  // Main loading state: waiting for currentUser to determine if parent can access\r\n  if (!currentUser && initialLoading) { \r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600\"></div>\r\n        <p className=\"ml-4 text-lg text-gray-700\">Loading user information...</p>\r\n      </div>\r\n    );\r\n  }\r\n  // If currentUser is loaded but not a parent or no ID (should be handled by ProtectedRoute, but as a fallback)\r\n  if (!currentUser || !currentUser.id) {\r\n      return <div className=\"p-6 text-center text-red-500\">Access Denied or User not properly loaded.</div>;\r\n  }\r\n\r\n  // Skeleton Loader for the form content area\r\n  const FormSkeleton = () => (\r\n    <div className=\"p-6 space-y-8 animate-pulse\">\r\n      {[...Array(5)].map((_, i) => (\r\n        <div key={i} className=\"space-y-4\">\r\n          <div className=\"h-6 bg-gray-300 rounded w-1/3 mb-2\"></div> {/* Section Title */}\r\n          <div className=\"space-y-2\">\r\n            <div className=\"h-10 bg-gray-300 rounded\"></div> {/* Input Field */}\r\n            {i < 2 && <div className=\"h-8 bg-gray-300 rounded w-1/4 mt-2\"></div>} {/* Add Button Placeholder */}\r\n          </div>\r\n        </div>\r\n      ))}\r\n      {/* Buttons Placeholder */}\r\n      <div className=\"flex justify-end space-x-3 pt-6 border-t border-gray-200 mt-6\">\r\n        <div className=\"h-10 bg-gray-300 rounded w-28\"></div> {/* Save Draft */}\r\n        <div className=\"h-10 bg-gray-300 rounded w-36\"></div> {/* Submit */}\r\n      </div>\r\n    </div>\r\n  );\r\n  \r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        <div className=\"bg-white rounded-lg shadow-lg\">          <div className=\"px-6 py-4 border-b border-gray-200\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <h1 className=\"text-2xl font-bold text-gray-900\">Health Declaration</h1>\r\n              <div className=\"space-x-2\">\r\n                <Link \r\n                  to=\"/parent/health-records\" \r\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\r\n                >\r\n                  View Health Records\r\n                </Link>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-sm text-gray-500 mt-1\">Submit a new health declaration for your child. You can view all submitted declarations in the Health Records section.</p>\r\n            {/* Child Selector */}\r\n            <div className=\"mt-4\">\r\n              <label htmlFor=\"studentCodeSelect\" className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Select Child\r\n              </label>\r\n              {initialLoading && children.length === 0 ? (\r\n                <div className=\"h-10 bg-gray-300 rounded animate-pulse w-full p-2 border border-gray-300\"></div>\r\n              ) : (\r\n                <select\r\n                  id=\"studentCodeSelect\"\r\n                  value={selectedStudentCode}\r\n                  onChange={(e) => {\r\n                    const newStudentCode = e.target.value;\r\n                    setSelectedStudentCode(newStudentCode);\r\n                    setValue('studentCode', newStudentCode); // Update RHF studentCode field\r\n                  }}\r\n                  className={`w-full p-2 border ${errors.studentCode ? 'border-red-500' : 'border-gray-300'} rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500`}\r\n                  disabled={children.length === 0 || initialLoading || isFetchingDeclaration}\r\n                >\r\n                  <option value=\"\">-- Select a child --</option>                  {children.map(child => (\r\n                    <option key={child.studentCode} value={child.studentCode}>\r\n                      {child.fullName}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              )}\r\n              {/* This error refers to the RHF studentCode */}\r\n              {errors.studentCode && <p className=\"text-red-600 text-sm mt-1\">{errors.studentCode.message}</p>}\r\n              {!initialLoading && children.length === 0 && <p className=\"text-sm text-gray-500 mt-1\">No children found for your account.</p>}\r\n            </div>\r\n          </div>\r\n\r\n          {isFetchingDeclaration && selectedStudentCode ? (\r\n            <FormSkeleton />\r\n          ) : !selectedStudentCode && !initialLoading ? (\r\n            // Message to show if children are loaded but none is selected yet\r\n            <p className=\"p-6 text-gray-600 text-center\">Please select a child to view or complete their health declaration.</p>\r\n          ) : selectedStudentCode && !isFetchingDeclaration ? (\r\n            // Only render form if a child is selected and data is not being fetched\r\n            <form onSubmit={handleSubmit(onSubmit)} className=\"p-6 space-y-8\">\r\n              {/* Hidden studentCode field for react-hook-form validation, value set by fetch/reset */}\r\n              <Controller name=\"studentCode\" control={control} render={({ field }) => <input type=\"hidden\" {...field} />} />\r\n\r\n              {/* Allergies Section */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Allergies</h3>\r\n                <Controller\r\n                  name=\"allergies\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <div className=\"space-y-2\">\r\n                      {(field.value || []).map((allergy, index) => (\r\n                        <AllergyItem\r\n                          key={`allergy-${index}`} \r\n                          allergy={allergy}\r\n                          index={index}\r\n                          onChange={(idx, val) => handleSimpleArrayItemChange('allergies', idx, val)}\r\n                          onRemove={() => removeArrayItem('allergies', index)}\r\n                        />\r\n                      ))}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => addArrayItem('allergies', '')}\r\n                        className=\"text-indigo-600 hover:text-indigo-800 text-sm\"\r\n                        disabled={isFetchingDeclaration || submitting}\r\n                      >\r\n                        <i className=\"fas fa-plus mr-1\"></i> Add Allergy\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                />\r\n                 {errors.allergies?.map((err, i) => err && <p key={`err-allergy-${i}`} className=\"text-red-600 text-sm mt-1\">{err.message || \"Allergy entry cannot be empty.\"}</p>)}\r\n              </div>              {/* Chronic Illnesses Section */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Chronic Illnesses</h3>\r\n                <Controller\r\n                  name=\"chronicIllnesses\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <div className=\"space-y-2\">\r\n                      {(field.value || []).map((illness, index) => (\r\n                        <ChronicIllnessItem\r\n                          key={`chronic-${index}`}\r\n                          illness={illness}\r\n                          index={index}\r\n                          onChange={(idx, val) => handleSimpleArrayItemChange('chronicIllnesses', idx, val)}\r\n                          onRemove={() => removeArrayItem('chronicIllnesses', index)}\r\n                        />\r\n                      ))}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => addArrayItem('chronicIllnesses', '')}\r\n                        className=\"text-indigo-600 hover:text-indigo-800 text-sm\"\r\n                        disabled={isFetchingDeclaration || submitting}\r\n                      >\r\n                        <i className=\"fas fa-plus mr-1\"></i> Add Chronic Illness\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                />\r\n                {errors.chronicIllnesses?.map((err, i) => err && <p key={`err-chronic-${i}`} className=\"text-red-600 text-sm mt-1\">{err.message || \"Chronic illness entry cannot be empty.\"}</p>)}\r\n              </div>\r\n              \r\n              {/* Medical History Section */}\r\n              <div className=\"space-y-1\">\r\n                <label htmlFor=\"medicalHistory\" className=\"block text-lg font-semibold text-gray-900\">Relevant Medical History</label>\r\n                <Controller\r\n                    name=\"medicalHistory\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                        <textarea\r\n                            {...field}\r\n                            id=\"medicalHistory\"\r\n                            rows=\"4\"\r\n                            className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\"\r\n                            placeholder=\"Describe any relevant past surgeries, hospitalizations, or significant medical conditions.\"\r\n                            disabled={isFetchingDeclaration || submitting}\r\n                        />\r\n                    )}\r\n                />\r\n                {errors.medicalHistory && <p className=\"text-red-600 text-sm mt-1\">{errors.medicalHistory.message}</p>}\r\n              </div>\r\n\r\n              {/* Emergency Contacts Section */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Emergency Contacts</h3>\r\n                <Controller\r\n                  name=\"emergencyContacts\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <div className=\"space-y-4\">\r\n                      {(field.value || []).map((contact, index) => (\r\n                        <EmergencyContactItem\r\n                          key={`contact-${index}`}\r\n                          contact={contact}\r\n                          index={index}\r\n                          onChange={(idx, e) => handleNestedObjectArrayItemChange('emergencyContacts', idx, e)}\r\n                          onRemove={() => removeArrayItem('emergencyContacts', index)}\r\n                        />\r\n                      ))}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => addArrayItem('emergencyContacts', { name: '', relationship: '', phone: '', isEmergency: true })}\r\n                        className=\"text-indigo-600 hover:text-indigo-800 text-sm\"\r\n                        disabled={isFetchingDeclaration || submitting}\r\n                      >\r\n                        <i className=\"fas fa-plus mr-1\"></i> Add Emergency Contact\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                />\r\n                {errors.emergencyContacts && <p className=\"text-red-600 text-sm mt-1\">{errors.emergencyContacts.message || \"Please ensure all emergency contact fields are correctly filled (name, relationship, phone are required).\"}</p>}\r\n              </div>\r\n\r\n              {/* Vision and Hearing Status Section */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"space-y-1\">\r\n                    <label htmlFor=\"visionStatus\" className=\"block text-lg font-semibold text-gray-900\">Vision Status</label>\r\n                    <Controller\r\n                        name=\"visionStatus\"\r\n                        control={control}\r\n                        render={({ field }) => (\r\n                            <input\r\n                                {...field}\r\n                                type=\"text\"\r\n                                id=\"visionStatus\"\r\n                                className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\"\r\n                                placeholder=\"e.g., Wears glasses, 20/20\"\r\n                                disabled={isFetchingDeclaration || submitting}\r\n                            />\r\n                        )}\r\n                    />\r\n                    {errors.visionStatus && <p className=\"text-red-600 text-sm mt-1\">{errors.visionStatus.message}</p>}\r\n                </div>\r\n                <div className=\"space-y-1\">\r\n                    <label htmlFor=\"hearingStatus\" className=\"block text-lg font-semibold text-gray-900\">Hearing Status</label>\r\n                    <Controller\r\n                        name=\"hearingStatus\"\r\n                        control={control}\r\n                        render={({ field }) => (\r\n                            <input\r\n                                {...field}\r\n                                type=\"text\"\r\n                                id=\"hearingStatus\"\r\n                                className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\"\r\n                                placeholder=\"e.g., Normal, Uses hearing aids\"\r\n                                disabled={isFetchingDeclaration || submitting}\r\n                            />\r\n                        )}\r\n                    />\r\n                    {errors.hearingStatus && <p className=\"text-red-600 text-sm mt-1\">{errors.hearingStatus.message}</p>}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Vaccinations Section */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900\">Vaccinations</h3>\r\n                <Controller\r\n                  name=\"vaccinations\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <div className=\"space-y-4\">\r\n                      {(field.value || []).map((vaccination, index) => (\r\n                        <VaccinationItem\r\n                          key={`vaccination-${index}`}\r\n                          vaccination={vaccination}\r\n                          index={index}\r\n                          onChange={(idx, e) => handleNestedObjectArrayItemChange('vaccinations', idx, e)}\r\n                          onRemove={() => removeArrayItem('vaccinations', index)}\r\n                        />\r\n                      ))}\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={() => addArrayItem('vaccinations', { vaccineName: '', vaccinationDate: '', notes: '' })}\r\n                        className=\"text-indigo-600 hover:text-indigo-800 text-sm\"\r\n                        disabled={isFetchingDeclaration || submitting}\r\n                      >\r\n                        <i className=\"fas fa-plus mr-1\"></i> Add Vaccination\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                />\r\n                {errors.vaccinations && <p className=\"text-red-600 text-sm mt-1\">Please ensure all vaccination fields are correctly filled (vaccine name and date are required).</p>}\r\n              </div>\r\n\r\n              {/* Other Health Information Section */}\r\n              <div>\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Other Health Information</h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-8\">\r\n                    {/* Special Needs */}\r\n                    <div className=\"space-y-1\">\r\n                        <label htmlFor=\"specialNeeds\" className=\"block text-sm font-medium text-gray-700\">Special Needs or Accommodations</label>\r\n                        <Controller name=\"specialNeeds\" control={control} render={({ field }) => ( <textarea {...field} id=\"specialNeeds\" rows=\"3\" className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\" placeholder=\"Describe any special needs...\" disabled={isFetchingDeclaration || submitting}/> )}/>\r\n                        {errors.specialNeeds && <p className=\"text-red-600 text-sm mt-1\">{errors.specialNeeds.message}</p>}\r\n                    </div>\r\n                    {/* Physical Limitations */}\r\n                    <div className=\"space-y-1\">\r\n                        <label htmlFor=\"physicalLimitations\" className=\"block text-sm font-medium text-gray-700\">Physical Limitations or Activity Restrictions</label>\r\n                        <Controller name=\"physicalLimitations\" control={control} render={({ field }) => ( <textarea {...field} id=\"physicalLimitations\" rows=\"3\" className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\" placeholder=\"Describe any physical limitations...\" disabled={isFetchingDeclaration || submitting}/> )}/>\r\n                        {errors.physicalLimitations && <p className=\"text-red-600 text-sm mt-1\">{errors.physicalLimitations.message}</p>}\r\n                    </div>\r\n                    {/* Mental Health Concerns */}\r\n                    <div className=\"space-y-1\">\r\n                        <label htmlFor=\"mentalHealthConcerns\" className=\"block text-sm font-medium text-gray-700\">Mental or Emotional Health Concerns</label>\r\n                        <Controller name=\"mentalHealthConcerns\" control={control} render={({ field }) => ( <textarea {...field} id=\"mentalHealthConcerns\" rows=\"3\" className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\" placeholder=\"Describe any mental health concerns...\" disabled={isFetchingDeclaration || submitting}/> )}/>\r\n                        {errors.mentalHealthConcerns && <p className=\"text-red-600 text-sm mt-1\">{errors.mentalHealthConcerns.message}</p>}\r\n                    </div>\r\n                    {/* Dietary Restrictions */}\r\n                    <div className=\"space-y-1\">\r\n                        <label htmlFor=\"dietaryRestrictions\" className=\"block text-sm font-medium text-gray-700\">Dietary Restrictions or Preferences</label>\r\n                        <Controller name=\"dietaryRestrictions\" control={control} render={({ field }) => ( <textarea {...field} id=\"dietaryRestrictions\" rows=\"3\" className=\"w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500\" placeholder=\"e.g., Vegetarian, Gluten-free...\" disabled={isFetchingDeclaration || submitting}/> )}/>\r\n                        {errors.dietaryRestrictions && <p className=\"text-red-600 text-sm mt-1\">{errors.dietaryRestrictions.message}</p>}\r\n                    </div>\r\n                </div>\r\n              </div>              {/* Submission Buttons */}\r\n              <div className=\"flex justify-end space-x-3 pt-6 border-t border-gray-200\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleCancel}\r\n                  disabled={submitting}\r\n                  className=\"px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={submitting || isFetchingDeclaration || !selectedStudentCode || initialLoading}\r\n                  className=\"px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\r\n                >\r\n                  {submitting ? 'Submitting...' : 'Submit Declaration'}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          ) : null} \r\n          {/* Fallback for when no child is selected and children have loaded, or initial child loading is still in progress and no child selected */}\r\n          { !selectedStudentCode && !initialLoading && children.length > 0 &&\r\n             <p className=\"p-6 text-gray-600 text-center\">Please select a child to continue.</p>\r\n          }\r\n          { !selectedStudentCode && initialLoading &&\r\n             <p className=\"p-6 text-gray-600 text-center\">Loading children...</p> // This might briefly show if children array is empty during initial load\r\n          }\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default HealthDeclaration;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}