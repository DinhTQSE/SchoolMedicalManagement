{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useForm,Controller}from'react-hook-form';import{yupResolver}from'@hookform/resolvers/yup';import*as yup from'yup';import axios from'axios';import{useAlert}from'../../hooks/useAlert';// Import useAlert hook\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const schema=yup.object().shape({studentCode:yup.string().required('Student selection is required'),eventType:yup.string().required('Event type is required'),severity:yup.string().required('Severity is required'),symptoms:yup.array().min(1,'At least one symptom is required'),description:yup.string().required('Description is required'),actionTaken:yup.string().required('Action taken is required'),medicationGiven:yup.string(),parentNotified:yup.boolean(),referredTo:yup.string(),followUpRequired:yup.boolean(),followUpDate:yup.date().nullable().when('followUpRequired',{is:val=>val===true,// Corrected condition for .when\nthen:schema=>schema.required('Follow-up date is required').typeError('Invalid date')// Corrected usage of then\n}),status:yup.string().required('Status is required')// Added status field\n});const MedicalEvents=()=>{const{successAlert,errorAlert,deleteConfirm}=useAlert();// Initialize useAlert hook\nconst[events,setEvents]=useState([]);const[students,setStudents]=useState([]);const[loading,setLoading]=useState(true);const[submitting,setSubmitting]=useState(false);const[showForm,setShowForm]=useState(false);const[selectedEvent,setSelectedEvent]=useState(null);const[filters,setFilters]=useState({dateRange:'today',severity:'',eventType:'',status:'',studentCode:''});const handleFilterChange=(filterName,value)=>{setFilters(prevFilters=>({...prevFilters,[filterName]:value}));};const{control,handleSubmit,reset,watch,formState:{errors}}=useForm({resolver:yupResolver(schema),defaultValues:{symptoms:[],parentNotified:false,followUpRequired:false,studentCode:'',eventType:'',severity:'',description:'',actionTaken:'',medicationGiven:'',referredTo:'',followUpDate:null,// Ensure it's null by default\nstatus:'active'// Added default status\n}});const watchFollowUpRequired=watch('followUpRequired');// useEffect to fetch students on component mount\nuseEffect(()=>{fetchStudents();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);// Empty dependency array means this runs once on mount\n// useEffect to fetch medical events when filters change or on initial load (due to initial filters state)\nuseEffect(()=>{fetchMedicalEvents();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[filters]);const fetchMedicalEvents=async()=>{setLoading(true);// Set loading to true when fetching starts\ntry{const token=localStorage.getItem('token');const queryParams={};// Initialize as an empty object\nif(filters.severity)queryParams.severity=filters.severity;if(filters.eventType)queryParams.eventType=filters.eventType;if(filters.status)queryParams.status=filters.status;if(filters.studentCode)queryParams.studentCode=filters.studentCode;const today=new Date();let startDate,endDate;switch(filters.dateRange){case'today':startDate=today;endDate=today;break;case'week':const currentDay=today.getDay();const firstDayOfWeek=new Date(today);firstDayOfWeek.setDate(today.getDate()-(currentDay===0?6:currentDay-1));startDate=firstDayOfWeek;endDate=new Date(startDate);endDate.setDate(startDate.getDate()+6);break;case'month':startDate=new Date(today.getFullYear(),today.getMonth(),1);endDate=new Date(today.getFullYear(),today.getMonth()+1,0);break;case'all':default:break;}const formatDateToYYYYMMDD=date=>{if(!date)return null;return date.toISOString().split('T')[0];};if(startDate&&filters.dateRange!=='all')queryParams.startDate=formatDateToYYYYMMDD(startDate);if(endDate&&filters.dateRange!=='all')queryParams.endDate=formatDateToYYYYMMDD(endDate);// queryParams are already filtered by only adding them if they have a value\nconst response=await axios.get('/api/medical-events',{headers:{Authorization:`Bearer ${token}`},params:queryParams});setEvents(response.data);}catch(error){console.error('Error fetching medical events:',error);}finally{setLoading(false);}};const fetchStudents=async()=>{try{const token=localStorage.getItem('token');const response=await axios.get('/api/students',{headers:{Authorization:`Bearer ${token}`}});setStudents(response.data);}catch(error){console.error('Error fetching students:',error);}};const onSubmit=async data=>{setSubmitting(true);try{const token=localStorage.getItem('token');if(selectedEvent){await axios.put(`/api/medical-events/${selectedEvent.id}`,data,{headers:{Authorization:`Bearer ${token}`}});successAlert('Medical event updated successfully!');}else{await axios.post('/api/medical-events',data,{headers:{Authorization:`Bearer ${token}`}});successAlert('Medical event recorded successfully!');}reset();setShowForm(false);setSelectedEvent(null);fetchMedicalEvents();}catch(error){console.error('Error saving medical event:',error);errorAlert('Error saving medical event. Please try again.');}finally{setSubmitting(false);}};const handleDeleteEvent=async eventId=>{const confirmed=await deleteConfirm('Are you sure you want to delete this medical event?');if(confirmed){try{const token=localStorage.getItem('token');await axios.delete(`/api/medical-events/${eventId}`,{headers:{Authorization:`Bearer ${token}`}});successAlert('Medical event deleted successfully!');fetchMedicalEvents();// Refresh the list\n}catch(error){console.error('Error deleting medical event:',error);errorAlert('Error deleting medical event. Please try again.');}}};const handleSymptomChange=(symptom,checked,field)=>{const currentSymptoms=field.value||[];if(checked){field.onChange([...currentSymptoms,symptom]);}else{field.onChange(currentSymptoms.filter(s=>s!==symptom));}};const editEvent=event=>{setSelectedEvent(event);reset({...event,studentCode:event.studentCode||'',// DTO directly provides studentCode\n// Ensure date fields are correctly formatted if necessary\neventDate:event.eventDate?new Date(event.eventDate).toISOString().split('T')[0]:null,// Added for consistency if needed by a date picker for eventDate\nfollowUpDate:event.followUpDate?new Date(event.followUpDate).toISOString().split('T')[0]:null,// Ensure symptoms is an array\nsymptoms:Array.isArray(event.symptoms)?event.symptoms:[],// status will be spread from event if present, or use existing if not in event for some reason\nstatus:event.status||'active'});setShowForm(true);};const getSeverityBadge=severity=>{const badges={low:'bg-green-100 text-green-800',medium:'bg-yellow-100 text-yellow-800',high:'bg-red-100 text-red-800',critical:'bg-red-500 text-white'};return badges[severity]||'bg-gray-100 text-gray-800';};const getStatusBadge=status=>{const badges={active:'bg-blue-100 text-blue-800',resolved:'bg-green-100 text-green-800',follow_up:'bg-yellow-100 text-yellow-800',referred:'bg-purple-100 text-purple-800'};return badges[status]||'bg-gray-100 text-gray-800';};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600\"})});}return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:\"Medical Events Management\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mt-1\",children:\"Record and manage medical incidents and health events\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{setSelectedEvent(null);reset();setShowForm(!showForm);},className:\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus mr-2\"}),showForm?'Cancel':'Record Event']})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow mb-6 p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-5 gap-4\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Student\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.studentCode,onChange:e=>handleFilterChange('studentCode',e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Students\"}),students.map(student=>/*#__PURE__*/_jsxs(\"option\",{value:student.studentCode,children:[student.fullName,\" (\",student.studentCode,\")\"]},student.studentCode))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Date Range\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.dateRange,onChange:e=>handleFilterChange('dateRange',e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"today\",children:\"Today\"}),/*#__PURE__*/_jsx(\"option\",{value:\"week\",children:\"This Week\"}),/*#__PURE__*/_jsx(\"option\",{value:\"month\",children:\"This Month\"}),/*#__PURE__*/_jsx(\"option\",{value:\"all\",children:\"All Time\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Event Type\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.eventType,onChange:e=>handleFilterChange('eventType',e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Types\"}),/*#__PURE__*/_jsx(\"option\",{value:\"injury\",children:\"Injury\"}),/*#__PURE__*/_jsx(\"option\",{value:\"illness\",children:\"Illness\"}),/*#__PURE__*/_jsx(\"option\",{value:\"accident\",children:\"Accident\"}),/*#__PURE__*/_jsx(\"option\",{value:\"emergency\",children:\"Emergency\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medication\",children:\"Medication Related\"}),/*#__PURE__*/_jsx(\"option\",{value:\"outbreak\",children:\"Disease Outbreak\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fall\",children:\"Fall\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fever\",children:\"Fever\"}),/*#__PURE__*/_jsx(\"option\",{value:\"allergic_reaction\",children:\"Allergic Reaction\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Severity\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.severity,onChange:e=>handleFilterChange('severity',e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Severities\"}),/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High\"}),/*#__PURE__*/_jsx(\"option\",{value:\"critical\",children:\"Critical\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Status\"}),/*#__PURE__*/_jsxs(\"select\",{value:filters.status,onChange:e=>handleFilterChange('status',e.target.value),className:\"w-full p-2 border border-gray-300 rounded-md\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"All Statuses\"}),/*#__PURE__*/_jsx(\"option\",{value:\"active\",children:\"Active\"}),/*#__PURE__*/_jsx(\"option\",{value:\"resolved\",children:\"Resolved\"}),/*#__PURE__*/_jsx(\"option\",{value:\"follow_up\",children:\"Follow-up Required\"}),/*#__PURE__*/_jsx(\"option\",{value:\"referred\",children:\"Referred\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4\",children:/*#__PURE__*/_jsx(\"button\",{onClick:fetchMedicalEvents,className:\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\",children:\"Apply Filters\"})})]}),showForm&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900\",children:selectedEvent?'Edit Medical Event':'Record New Medical Event'})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Student *\"}),/*#__PURE__*/_jsx(Controller,{name:\"studentCode\",control:control,render:_ref=>{let{field}=_ref;return/*#__PURE__*/_jsxs(\"select\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select student\"}),students.map(student=>/*#__PURE__*/// Assuming student object has studentCode, fullName, className\n_jsxs(\"option\",{value:student.studentCode,children:[student.fullName,\" - \",student.className,\" (\",student.studentCode,\")\"]},student.studentCode))]});}}),errors.studentCode&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.studentCode.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Event Type *\"}),/*#__PURE__*/_jsx(Controller,{name:\"eventType\",control:control,render:_ref2=>{let{field}=_ref2;return/*#__PURE__*/_jsxs(\"select\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select event type\"}),/*#__PURE__*/_jsx(\"option\",{value:\"injury\",children:\"Injury\"}),/*#__PURE__*/_jsx(\"option\",{value:\"illness\",children:\"Illness\"}),/*#__PURE__*/_jsx(\"option\",{value:\"accident\",children:\"Accident\"}),/*#__PURE__*/_jsx(\"option\",{value:\"emergency\",children:\"Emergency\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medication\",children:\"Medication Related\"}),/*#__PURE__*/_jsx(\"option\",{value:\"outbreak\",children:\"Disease Outbreak\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fall\",children:\"Fall\"}),/*#__PURE__*/_jsx(\"option\",{value:\"fever\",children:\"Fever\"}),/*#__PURE__*/_jsx(\"option\",{value:\"allergic_reaction\",children:\"Allergic Reaction\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]});}}),errors.eventType&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.eventType.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Severity *\"}),/*#__PURE__*/_jsx(Controller,{name:\"severity\",control:control,render:_ref3=>{let{field}=_ref3;return/*#__PURE__*/_jsxs(\"select\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select severity\"}),/*#__PURE__*/_jsx(\"option\",{value:\"low\",children:\"Low - Minor issue, self-care\"}),/*#__PURE__*/_jsx(\"option\",{value:\"medium\",children:\"Medium - Requires attention\"}),/*#__PURE__*/_jsx(\"option\",{value:\"high\",children:\"High - Urgent care needed\"}),/*#__PURE__*/_jsx(\"option\",{value:\"critical\",children:\"Critical - Emergency response\"})]});}}),errors.severity&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.severity.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 mb-6\",children:[\" \",/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Status *\"}),/*#__PURE__*/_jsx(Controller,{name:\"status\",control:control,render:_ref4=>{let{field}=_ref4;return/*#__PURE__*/_jsxs(\"select\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"active\",children:\"Active\"}),/*#__PURE__*/_jsx(\"option\",{value:\"resolved\",children:\"Resolved\"}),/*#__PURE__*/_jsx(\"option\",{value:\"follow_up\",children:\"Follow-up Required\"}),/*#__PURE__*/_jsx(\"option\",{value:\"referred\",children:\"Referred\"})]});}}),errors.status&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.status.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Symptoms Observed *\"}),/*#__PURE__*/_jsx(Controller,{name:\"symptoms\",control:control,render:_ref5=>{let{field}=_ref5;return/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 md:grid-cols-4 gap-3\",children:['Fever','Headache','Nausea','Vomiting','Dizziness','Pain','Swelling','Rash','Difficulty breathing','Fatigue','Confusion','Bleeding','Bruising','Loss of consciousness','Other'].map(symptom=>/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:(field.value||[]).includes(symptom),onChange:e=>handleSymptomChange(symptom,e.target.checked,field),className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:symptom})]},symptom))});}}),errors.symptoms&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.symptoms.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Detailed Description *\"}),/*#__PURE__*/_jsx(Controller,{name:\"description\",control:control,render:_ref6=>{let{field}=_ref6;return/*#__PURE__*/_jsx(\"textarea\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",rows:\"4\",placeholder:\"Provide detailed description of the incident, circumstances, and observations...\"});}}),errors.description&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.description.message})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Action Taken *\"}),/*#__PURE__*/_jsx(Controller,{name:\"actionTaken\",control:control,render:_ref7=>{let{field}=_ref7;return/*#__PURE__*/_jsx(\"textarea\",{...field,className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",rows:\"3\",placeholder:\"Describe the immediate actions taken, treatments provided, and care given...\"});}}),errors.actionTaken&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.actionTaken.message})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Medication Given\"}),/*#__PURE__*/_jsx(Controller,{name:\"medicationGiven\",control:control,render:_ref8=>{let{field}=_ref8;return/*#__PURE__*/_jsx(\"input\",{...field,type:\"text\",className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"List any medications administered\"});}})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Referred To\"}),/*#__PURE__*/_jsx(Controller,{name:\"referredTo\",control:control,render:_ref9=>{let{field}=_ref9;return/*#__PURE__*/_jsx(\"input\",{...field,type:\"text\",className:\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",placeholder:\"Doctor, hospital, or specialist if referred\"});}})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(Controller,{name:\"parentNotified\",control:control,render:_ref0=>{let{field}=_ref0;return/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:field.value,onChange:field.onChange,className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Parent/Guardian notified\"})]});}}),/*#__PURE__*/_jsx(Controller,{name:\"followUpRequired\",control:control,render:_ref1=>{let{field}=_ref1;return/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:field.value,onChange:field.onChange,className:\"mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm\",children:\"Follow-up required\"})]});}}),watchFollowUpRequired&&/*#__PURE__*/_jsxs(\"div\",{className:\"ml-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Follow-up Date *\"}),/*#__PURE__*/_jsx(Controller,{name:\"followUpDate\",control:control,render:_ref10=>{let{field}=_ref10;return/*#__PURE__*/_jsx(\"input\",{...field,type:\"date\",className:\"p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\",value:field.value?new Date(field.value).toISOString().split('T')[0]:'',onChange:e=>field.onChange(new Date(e.target.value))});}}),errors.followUpDate&&/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 text-sm mt-1\",children:errors.followUpDate.message})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-4 pt-6 border-t border-gray-200\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setShowForm(false);setSelectedEvent(null);reset();},className:\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:submitting,className:\"px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50\",children:submitting?'Saving...':selectedEvent?'Update Event':'Record Event'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-6 py-4 border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold text-gray-900\",children:\"Medical Events\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full divide-y divide-gray-200\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-gray-50\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Student\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Event Type\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Severity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Date/Time\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"bg-white divide-y divide-gray-200\",children:events.length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"px-6 py-4 text-center text-gray-500\",children:\"No medical events found\"})}):events.map(event=>{var _event$eventType,_event$status;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm font-medium text-gray-900\",children:[event.studentCode,\" \"]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-sm text-gray-900 capitalize\",children:(_event$eventType=event.eventType)===null||_event$eventType===void 0?void 0:_event$eventType.replace('_',' ')}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-500\",children:[Array.isArray(event.symptoms)?event.symptoms.slice(0,2).join(', '):'',Array.isArray(event.symptoms)&&event.symptoms.length>2&&'...']})]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getSeverityBadge(event.severity)}`,children:event.severity})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-6 py-4 whitespace-nowrap\",children:/*#__PURE__*/_jsx(\"span\",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusBadge(event.status)}`,children:(_event$status=event.status)===null||_event$status===void 0?void 0:_event$status.replace('_',' ')})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\",children:[event.eventDate?new Date(event.eventDate).toLocaleDateString():'N/A',/*#__PURE__*/_jsx(\"br\",{}),event.eventDate?new Date(event.eventDate).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}):'']}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-6 py-4 whitespace-nowrap text-sm font-medium\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>editEvent(event),className:\"text-indigo-600 hover:text-indigo-900 mr-4\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteEvent(event.id),className:\"text-red-600 hover:text-red-900 mr-4\",children:\"Delete\"})]})]},event.id);})})]})})]})]})});};export default MedicalEvents;// Ensure component is exported","map":{"version":3,"names":["React","useState","useEffect","useForm","Controller","yupResolver","yup","axios","useAlert","jsx","_jsx","jsxs","_jsxs","schema","object","shape","studentCode","string","required","eventType","severity","symptoms","array","min","description","actionTaken","medicationGiven","parentNotified","boolean","referredTo","followUpRequired","followUpDate","date","nullable","when","is","val","then","typeError","status","MedicalEvents","successAlert","errorAlert","deleteConfirm","events","setEvents","students","setStudents","loading","setLoading","submitting","setSubmitting","showForm","setShowForm","selectedEvent","setSelectedEvent","filters","setFilters","dateRange","handleFilterChange","filterName","value","prevFilters","control","handleSubmit","reset","watch","formState","errors","resolver","defaultValues","watchFollowUpRequired","fetchStudents","fetchMedicalEvents","token","localStorage","getItem","queryParams","today","Date","startDate","endDate","currentDay","getDay","firstDayOfWeek","setDate","getDate","getFullYear","getMonth","formatDateToYYYYMMDD","toISOString","split","response","get","headers","Authorization","params","data","error","console","onSubmit","put","id","post","handleDeleteEvent","eventId","confirmed","delete","handleSymptomChange","symptom","checked","field","currentSymptoms","onChange","filter","s","editEvent","event","eventDate","Array","isArray","getSeverityBadge","badges","low","medium","high","critical","getStatusBadge","active","resolved","follow_up","referred","className","children","onClick","e","target","map","student","fullName","name","render","_ref","message","_ref2","_ref3","_ref4","_ref5","type","includes","_ref6","rows","placeholder","_ref7","_ref8","_ref9","_ref0","_ref1","_ref10","disabled","length","colSpan","_event$eventType","_event$status","replace","slice","join","toLocaleDateString","toLocaleTimeString","hour","minute"],"sources":["C:/Users/trand/OneDrive/Documents/GitHub/SchoolMedicalManagement/SchoolMedicalManagement/frontend/src/pages/medical/MedicalEvents.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport * as yup from 'yup';\r\nimport axios from 'axios';\r\nimport { useAlert } from '../../hooks/useAlert'; // Import useAlert hook\r\n\r\nconst schema = yup.object().shape({\r\n  studentCode: yup.string().required('Student selection is required'),\r\n  eventType: yup.string().required('Event type is required'),\r\n  severity: yup.string().required('Severity is required'),\r\n  symptoms: yup.array().min(1, 'At least one symptom is required'),\r\n  description: yup.string().required('Description is required'),\r\n  actionTaken: yup.string().required('Action taken is required'),\r\n  medicationGiven: yup.string(),\r\n  parentNotified: yup.boolean(),\r\n  referredTo: yup.string(),\r\n  followUpRequired: yup.boolean(),\r\n  followUpDate: yup.date().nullable().when('followUpRequired', {\r\n    is: (val) => val === true, // Corrected condition for .when\r\n    then: (schema) => schema.required('Follow-up date is required').typeError('Invalid date'), // Corrected usage of then\r\n  }),\r\n  status: yup.string().required('Status is required') // Added status field\r\n});\r\n\r\nconst MedicalEvents = () => {\r\n  const { successAlert, errorAlert, deleteConfirm } = useAlert(); // Initialize useAlert hook\r\n  const [events, setEvents] = useState([]);\r\n  const [students, setStudents] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [selectedEvent, setSelectedEvent] = useState(null);\r\n  const [filters, setFilters] = useState({\r\n    dateRange: 'today',\r\n    severity: '',\r\n    eventType: '',\r\n    status: '',\r\n    studentCode: ''\r\n  });\r\n\r\n  const handleFilterChange = (filterName, value) => {\r\n    setFilters(prevFilters => ({\r\n      ...prevFilters,\r\n      [filterName]: value\r\n    }));\r\n  };\r\n\r\n  const { control, handleSubmit, reset, watch, formState: { errors } } = useForm({\r\n    resolver: yupResolver(schema),\r\n    defaultValues: {\r\n      symptoms: [],\r\n      parentNotified: false,\r\n      followUpRequired: false,\r\n      studentCode: '',\r\n      eventType: '',\r\n      severity: '',\r\n      description: '',\r\n      actionTaken: '',\r\n      medicationGiven: '',\r\n      referredTo: '',\r\n      followUpDate: null, // Ensure it's null by default\r\n      status: 'active' // Added default status\r\n    }\r\n  });\r\n\r\n  const watchFollowUpRequired = watch('followUpRequired');\r\n\r\n  // useEffect to fetch students on component mount\r\n  useEffect(() => {\r\n    fetchStudents();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // Empty dependency array means this runs once on mount\r\n\r\n  // useEffect to fetch medical events when filters change or on initial load (due to initial filters state)\r\n  useEffect(() => {\r\n    fetchMedicalEvents();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [filters]);\r\n\r\n  const fetchMedicalEvents = async () => {\r\n    setLoading(true); // Set loading to true when fetching starts\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n\r\n      const queryParams = { }; // Initialize as an empty object\r\n\r\n      if (filters.severity) queryParams.severity = filters.severity;\r\n      if (filters.eventType) queryParams.eventType = filters.eventType;\r\n      if (filters.status) queryParams.status = filters.status;\r\n      if (filters.studentCode) queryParams.studentCode = filters.studentCode;\r\n\r\n      const today = new Date();\r\n      let startDate, endDate;\r\n\r\n      switch (filters.dateRange) {\r\n        case 'today':\r\n          startDate = today;\r\n          endDate = today;\r\n          break;\r\n        case 'week':\r\n          const currentDay = today.getDay();\r\n          const firstDayOfWeek = new Date(today);\r\n          firstDayOfWeek.setDate(today.getDate() - (currentDay === 0 ? 6 : currentDay - 1));\r\n          startDate = firstDayOfWeek;\r\n          \r\n          endDate = new Date(startDate);\r\n          endDate.setDate(startDate.getDate() + 6);          break;\r\n        case 'month':\r\n          startDate = new Date(today.getFullYear(), today.getMonth(), 1);\r\n          endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0);          break;\r\n        case 'all':\r\n        default:\r\n          break;\r\n      }\r\n\r\n      const formatDateToYYYYMMDD = (date) => {\r\n        if (!date) return null;\r\n        return date.toISOString().split('T')[0];\r\n      };\r\n\r\n      if (startDate && filters.dateRange !== 'all') queryParams.startDate = formatDateToYYYYMMDD(startDate);\r\n      if (endDate && filters.dateRange !== 'all') queryParams.endDate = formatDateToYYYYMMDD(endDate);\r\n      \r\n      // queryParams are already filtered by only adding them if they have a value\r\n\r\n      const response = await axios.get('/api/medical-events', {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n        params: queryParams\r\n      });\r\n      setEvents(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching medical events:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchStudents = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await axios.get('/api/students', {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      setStudents(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching students:', error);\r\n    }\r\n  };\r\n\r\n  const onSubmit = async (data) => {\r\n    setSubmitting(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (selectedEvent) {\r\n        await axios.put(`/api/medical-events/${selectedEvent.id}`, data, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        successAlert('Medical event updated successfully!');\r\n      } else {\r\n        await axios.post('/api/medical-events', data, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        successAlert('Medical event recorded successfully!');\r\n      }\r\n      \r\n      reset();\r\n      setShowForm(false);\r\n      setSelectedEvent(null);\r\n      fetchMedicalEvents();\r\n    } catch (error) {\r\n      console.error('Error saving medical event:', error);\r\n      errorAlert('Error saving medical event. Please try again.');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteEvent = async (eventId) => {\r\n    const confirmed = await deleteConfirm('Are you sure you want to delete this medical event?');\r\n    if (confirmed) {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        await axios.delete(`/api/medical-events/${eventId}`, {\r\n          headers: { Authorization: `Bearer ${token}` }\r\n        });\r\n        successAlert('Medical event deleted successfully!');\r\n        fetchMedicalEvents(); // Refresh the list\r\n      } catch (error) {\r\n        console.error('Error deleting medical event:', error);\r\n        errorAlert('Error deleting medical event. Please try again.');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSymptomChange = (symptom, checked, field) => {\r\n    const currentSymptoms = field.value || [];\r\n    if (checked) {\r\n      field.onChange([...currentSymptoms, symptom]);\r\n    } else {\r\n      field.onChange(currentSymptoms.filter(s => s !== symptom));\r\n    }\r\n  };\r\n\r\n  const editEvent = (event) => {\r\n    setSelectedEvent(event);\r\n    reset({\r\n      ...event, \r\n      studentCode: event.studentCode || '', // DTO directly provides studentCode\r\n      // Ensure date fields are correctly formatted if necessary\r\n      eventDate: event.eventDate ? new Date(event.eventDate).toISOString().split('T')[0] : null, // Added for consistency if needed by a date picker for eventDate\r\n      followUpDate: event.followUpDate ? new Date(event.followUpDate).toISOString().split('T')[0] : null,\r\n      // Ensure symptoms is an array\r\n      symptoms: Array.isArray(event.symptoms) ? event.symptoms : [],\r\n      // status will be spread from event if present, or use existing if not in event for some reason\r\n      status: event.status || 'active', \r\n    });\r\n    setShowForm(true);\r\n  };\r\n\r\n  const getSeverityBadge = (severity) => {\r\n    const badges = {\r\n      low: 'bg-green-100 text-green-800',\r\n      medium: 'bg-yellow-100 text-yellow-800',\r\n      high: 'bg-red-100 text-red-800',\r\n      critical: 'bg-red-500 text-white'\r\n    };\r\n    return badges[severity] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  const getStatusBadge = (status) => {\r\n    const badges = {\r\n      active: 'bg-blue-100 text-blue-800',\r\n      resolved: 'bg-green-100 text-green-800',\r\n      follow_up: 'bg-yellow-100 text-yellow-800',\r\n      referred: 'bg-purple-100 text-purple-800'\r\n    };\r\n    return badges[status] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 py-8\">\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n        {/* Header */}\r\n        <div className=\"bg-white rounded-lg shadow mb-6\">\r\n          <div className=\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\">\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold text-gray-900\">Medical Events Management</h1>\r\n              <p className=\"text-gray-600 mt-1\">Record and manage medical incidents and health events</p>\r\n            </div>\r\n            <button\r\n              onClick={() => {\r\n                setSelectedEvent(null);\r\n                reset();\r\n                setShowForm(!showForm);\r\n              }}\r\n              className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700\"\r\n            >\r\n              <i className=\"fas fa-plus mr-2\"></i>\r\n              {showForm ? 'Cancel' : 'Record Event'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <div className=\"bg-white rounded-lg shadow mb-6 p-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\"> {/* Changed to md:grid-cols-5 */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Student</label>\r\n              <select\r\n                value={filters.studentCode}\r\n                onChange={(e) => handleFilterChange('studentCode', e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n              >\r\n                <option value=\"\">All Students</option>\r\n                {students.map(student => (\r\n                  <option key={student.studentCode} value={student.studentCode}>\r\n                    {student.fullName} ({student.studentCode})\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Date Range</label>\r\n              <select\r\n                value={filters.dateRange}\r\n                onChange={(e) => handleFilterChange('dateRange', e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n              >\r\n                <option value=\"today\">Today</option>\r\n                <option value=\"week\">This Week</option>\r\n                <option value=\"month\">This Month</option>\r\n                <option value=\"all\">All Time</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Event Type</label>\r\n              <select\r\n                value={filters.eventType}\r\n                onChange={(e) => handleFilterChange('eventType', e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n              >\r\n                <option value=\"\">All Types</option>\r\n                <option value=\"injury\">Injury</option>\r\n                <option value=\"illness\">Illness</option>\r\n                <option value=\"accident\">Accident</option>\r\n                <option value=\"emergency\">Emergency</option>\r\n                <option value=\"medication\">Medication Related</option>\r\n                <option value=\"outbreak\">Disease Outbreak</option>\r\n                <option value=\"fall\">Fall</option>\r\n                <option value=\"fever\">Fever</option>\r\n                <option value=\"allergic_reaction\">Allergic Reaction</option>\r\n                <option value=\"other\">Other</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Severity</label>\r\n              <select\r\n                value={filters.severity}\r\n                onChange={(e) => handleFilterChange('severity', e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n              >\r\n                <option value=\"\">All Severities</option>\r\n                <option value=\"low\">Low</option>\r\n                <option value=\"medium\">Medium</option>\r\n                <option value=\"high\">High</option>\r\n                <option value=\"critical\">Critical</option>\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">Status</label>\r\n              <select\r\n                value={filters.status}\r\n                onChange={(e) => handleFilterChange('status', e.target.value)}\r\n                className=\"w-full p-2 border border-gray-300 rounded-md\"\r\n              >\r\n                <option value=\"\">All Statuses</option>\r\n                <option value=\"active\">Active</option>\r\n                <option value=\"resolved\">Resolved</option>\r\n                <option value=\"follow_up\">Follow-up Required</option>\r\n                <option value=\"referred\">Referred</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n          <div className=\"mt-4\">\r\n            <button\r\n              onClick={fetchMedicalEvents}\r\n              className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\"\r\n            >\r\n              Apply Filters\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Medical Event Form */}\r\n        {showForm && (\r\n          <div className=\"bg-white rounded-lg shadow mb-6\">\r\n            <div className=\"px-6 py-4 border-b border-gray-200\">\r\n              <h2 className=\"text-xl font-semibold text-gray-900\">\r\n                {selectedEvent ? 'Edit Medical Event' : 'Record New Medical Event'}\r\n              </h2>\r\n            </div>\r\n            \r\n            <form onSubmit={handleSubmit(onSubmit)} className=\"p-6 space-y-6\">\r\n              {/* Basic Information */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Student *\r\n                  </label>\r\n                  <Controller\r\n                    name=\"studentCode\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <select\r\n                        {...field}\r\n                        className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                      >\r\n                        <option value=\"\">Select student</option>\r\n                        {students.map(student => (\r\n                          // Assuming student object has studentCode, fullName, className\r\n                          <option key={student.studentCode} value={student.studentCode}>\r\n                            {student.fullName} - {student.className} ({student.studentCode})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    )}\r\n                  />\r\n                  {errors.studentCode && (\r\n                    <p className=\"text-red-600 text-sm mt-1\">{errors.studentCode.message}</p>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Event Type *\r\n                  </label>\r\n                  <Controller\r\n                    name=\"eventType\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <select\r\n                        {...field}\r\n                        className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                      >\r\n                        <option value=\"\">Select event type</option>\r\n                        <option value=\"injury\">Injury</option>\r\n                        <option value=\"illness\">Illness</option>\r\n                        <option value=\"accident\">Accident</option>\r\n                        <option value=\"emergency\">Emergency</option>\r\n                        <option value=\"medication\">Medication Related</option>\r\n                        <option value=\"outbreak\">Disease Outbreak</option>\r\n                        <option value=\"fall\">Fall</option>\r\n                        <option value=\"fever\">Fever</option>\r\n                        <option value=\"allergic_reaction\">Allergic Reaction</option>\r\n                        <option value=\"other\">Other</option>\r\n                      </select>\r\n                    )}\r\n                  />\r\n                  {errors.eventType && (\r\n                    <p className=\"text-red-600 text-sm mt-1\">{errors.eventType.message}</p>\r\n                  )}\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Severity *\r\n                  </label>\r\n                  <Controller\r\n                    name=\"severity\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <select\r\n                        {...field}\r\n                        className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                      >\r\n                        <option value=\"\">Select severity</option>\r\n                        <option value=\"low\">Low - Minor issue, self-care</option>\r\n                        <option value=\"medium\">Medium - Requires attention</option>\r\n                        <option value=\"high\">High - Urgent care needed</option>\r\n                        <option value=\"critical\">Critical - Emergency response</option>\r\n                      </select>\r\n                    )}\r\n                  />\r\n                  {errors.severity && (\r\n                    <p className=\"text-red-600 text-sm mt-1\">{errors.severity.message}</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Status Field - ADDED */}\r\n              <div className=\"mt-6 mb-6\"> {/* Added mb-6 for spacing */}\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Status *\r\n                </label>\r\n                <Controller\r\n                  name=\"status\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <select\r\n                      {...field}\r\n                      className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                    >\r\n                      <option value=\"active\">Active</option>\r\n                      <option value=\"resolved\">Resolved</option>\r\n                      <option value=\"follow_up\">Follow-up Required</option>\r\n                      <option value=\"referred\">Referred</option>\r\n                    </select>\r\n                  )}\r\n                />\r\n                {errors.status && (\r\n                  <p className=\"text-red-600 text-sm mt-1\">{errors.status.message}</p>\r\n                )}\r\n              </div>\r\n\r\n\r\n              {/* Symptoms */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Symptoms Observed *\r\n                </label>\r\n                <Controller\r\n                  name=\"symptoms\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3\">\r\n                      {[\r\n                        'Fever', 'Headache', 'Nausea', 'Vomiting', 'Dizziness',\r\n                        'Pain', 'Swelling', 'Rash', 'Difficulty breathing', 'Fatigue',\r\n                        'Confusion', 'Bleeding', 'Bruising', 'Loss of consciousness', 'Other'\r\n                      ].map(symptom => (\r\n                        <label key={symptom} className=\"flex items-center\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={(field.value || []).includes(symptom)}\r\n                            onChange={(e) => handleSymptomChange(symptom, e.target.checked, field)}\r\n                            className=\"mr-2\"\r\n                          />\r\n                          <span className=\"text-sm\">{symptom}</span>\r\n                        </label>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                />\r\n                {errors.symptoms && (\r\n                  <p className=\"text-red-600 text-sm mt-1\">{errors.symptoms.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Description */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Detailed Description *\r\n                </label>\r\n                <Controller\r\n                  name=\"description\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <textarea\r\n                      {...field}\r\n                      className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                      rows=\"4\"\r\n                      placeholder=\"Provide detailed description of the incident, circumstances, and observations...\"\r\n                    />\r\n                  )}\r\n                />\r\n                {errors.description && (\r\n                  <p className=\"text-red-600 text-sm mt-1\">{errors.description.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Action Taken */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                  Action Taken *\r\n                </label>\r\n                <Controller\r\n                  name=\"actionTaken\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <textarea\r\n                      {...field}\r\n                      className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                      rows=\"3\"\r\n                      placeholder=\"Describe the immediate actions taken, treatments provided, and care given...\"\r\n                    />\r\n                  )}\r\n                />\r\n                {errors.actionTaken && (\r\n                  <p className=\"text-red-600 text-sm mt-1\">{errors.actionTaken.message}</p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Additional Information */}\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Medication Given\r\n                  </label>\r\n                  <Controller\r\n                    name=\"medicationGiven\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <input\r\n                        {...field}\r\n                        type=\"text\"\r\n                        className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                        placeholder=\"List any medications administered\"\r\n                      />\r\n                    )}\r\n                  />\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                    Referred To\r\n                  </label>\r\n                  <Controller\r\n                    name=\"referredTo\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <input\r\n                        {...field}\r\n                        type=\"text\"\r\n                        className=\"w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                        placeholder=\"Doctor, hospital, or specialist if referred\"\r\n                      />\r\n                    )}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {/* Checkboxes */}\r\n              <div className=\"space-y-3\">\r\n                <Controller\r\n                  name=\"parentNotified\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <label className=\"flex items-center\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={field.value}\r\n                        onChange={field.onChange}\r\n                        className=\"mr-2\"\r\n                      />\r\n                      <span className=\"text-sm\">Parent/Guardian notified</span>\r\n                    </label>\r\n                  )}\r\n                />\r\n\r\n                <Controller\r\n                  name=\"followUpRequired\"\r\n                  control={control}\r\n                  render={({ field }) => (\r\n                    <label className=\"flex items-center\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={field.value}\r\n                        onChange={field.onChange}\r\n                        className=\"mr-2\"\r\n                      />\r\n                      <span className=\"text-sm\">Follow-up required</span>\r\n                    </label>\r\n                  )}\r\n                />\r\n\r\n                {watchFollowUpRequired && (\r\n                  <div className=\"ml-6\">\r\n                    <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                      Follow-up Date *\r\n                    </label>\r\n                    <Controller\r\n                      name=\"followUpDate\"\r\n                      control={control}\r\n                      render={({ field }) => (\r\n                        <input\r\n                          {...field}\r\n                          type=\"date\"\r\n                          className=\"p-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500\"\r\n                          value={field.value ? new Date(field.value).toISOString().split('T')[0] : ''}\r\n                          onChange={(e) => field.onChange(new Date(e.target.value))}\r\n                        />\r\n                      )}\r\n                    />\r\n                    {errors.followUpDate && (\r\n                      <p className=\"text-red-600 text-sm mt-1\">{errors.followUpDate.message}</p>\r\n                    )}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Submit Buttons */}\r\n              <div className=\"flex justify-end space-x-4 pt-6 border-t border-gray-200\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => {\r\n                    setShowForm(false);\r\n                    setSelectedEvent(null);\r\n                    reset();\r\n                  }}\r\n                  className=\"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={submitting}\r\n                  className=\"px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50\"\r\n                >\r\n                  {submitting ? 'Saving...' : (selectedEvent ? 'Update Event' : 'Record Event')}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        )}\r\n\r\n        {/* Events List */}\r\n        <div className=\"bg-white rounded-lg shadow\">\r\n          <div className=\"px-6 py-4 border-b border-gray-200\">\r\n            <h2 className=\"text-xl font-semibold text-gray-900\">Medical Events</h2>\r\n          </div>\r\n          \r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"min-w-full divide-y divide-gray-200\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Student\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Event Type\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Severity\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Status\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Date/Time\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {events.length === 0 ? (\r\n                  <tr>\r\n                    <td colSpan=\"6\" className=\"px-6 py-4 text-center text-gray-500\">\r\n                      No medical events found\r\n                    </td>\r\n                  </tr>\r\n                ) : (\r\n                  events.map((event) => (\r\n                    <tr key={event.id} className=\"hover:bg-gray-50\">\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm font-medium text-gray-900\">\r\n                          {event.studentCode} {/* Display student code */}\r\n                        </div>\r\n                        {/* Student's full name and class are not directly in event DTO */}\r\n                        {/* To display them, you might need to find the student in the `students` array */}\r\n                        {/* Example: students.find(s => s.studentCode === event.studentCode)?.fullName */}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <div className=\"text-sm text-gray-900 capitalize\">\r\n                          {event.eventType?.replace('_', ' ')}\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-500\">\r\n                          {Array.isArray(event.symptoms) ? event.symptoms.slice(0, 2).join(', ') : ''}\r\n                          {Array.isArray(event.symptoms) && event.symptoms.length > 2 && '...'}\r\n                        </div>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getSeverityBadge(event.severity)}`}>\r\n                          {event.severity}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusBadge(event.status)}`}>\r\n                          {event.status?.replace('_', ' ')}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                        {event.eventDate ? new Date(event.eventDate).toLocaleDateString() : 'N/A'}\r\n                        <br />\r\n                        {event.eventDate ? new Date(event.eventDate).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : ''}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\r\n                        <button\r\n                          onClick={() => editEvent(event)}\r\n                          className=\"text-indigo-600 hover:text-indigo-900 mr-4\"\r\n                        >\r\n                          Edit\r\n                        </button>\r\n                        <button\r\n                          onClick={() => handleDeleteEvent(event.id)}\r\n                          className=\"text-red-600 hover:text-red-900 mr-4\"\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MedicalEvents; // Ensure component is exported\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}